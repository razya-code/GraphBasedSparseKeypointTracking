# GraphBasedSparseKeypointTracking

This project extends the capabilities of the original [DINO Tracker](https://github.com/AssafSinger94/dino-tracker) by incorporating GNN-based keypoint tracking, using pseudo labels generated by [PoseAnything](https://github.com/orhir/PoseAnything).

---

## ğŸ”§ Prerequisites

Before getting started, make sure to follow the installation and setup instructions in both:
- [DINO Tracker README](https://github.com/AssafSinger94/dino-tracker)
- [PoseAnything README](https://github.com/orhir/PoseAnything)

---

## ğŸ§ª Step 1: Generate Pseudo Labels with PoseAnything

Use `PoseAnything` to generate pose-based pseudo labels:

```bash
python PoseAnything/psuedo_labels_generator.py \
  --support path/to/support.jpg \
  --queries path/to/query1.jpg path/to/query2.jpg \
  --config configs/pose_model_config.py \
  --checkpoint checkpoints/model.pth \
  --outdir output
```

This will produce output in:

```
PoseAnything/readyoutputs/<sequence_name>/pose_results.json
```

---

## âš™ï¸ Step 2: Convert Pseudo Labels for DINO Tracker GNN

Run the following script to convert the generated pose data to the format expected by `DINO Tracker GNN`:

```bash
python scripts/run_pose_pipeline.py <sequence_name>
```

This will:
- Adjust the JSON structure to match the format expected by DINO Tracker GNN.
- Generate an adjacency matrix and rescaled keypoints.
- Produce:
  - Adjusted `pose_results_adjusted.json`
  - Annotated frames
  - Output video for visualization

---

## ğŸ§  Step 3: Train the GNN-Based Tracker

Make sure to first **train the original DINO Tracker** and place the relevant checkpoint files as expected (see the DINO Tracker repository for training instructions).

Then, you're ready to train and evaluate the GNN-based DINO Tracker on your pseudo-labeled sequences.

---

## ğŸ“ Directory Structure Overview

```
Lumenova/
â”œâ”€â”€ PoseAnything/
â”‚   â””â”€â”€ readyoutputs/
â”‚       â””â”€â”€ <sequence_name>/
â”‚           â””â”€â”€ pose_results.json
â”œâ”€â”€ output/
â”‚   â””â”€â”€ <sequence_name>_output/
â”‚       â”œâ”€â”€ pose_results_adjusted.json
â”‚       â”œâ”€â”€ annotated_frames/
â”‚       â””â”€â”€ <sequence_name>_output_from_pose.mp4
```

---

## ğŸ“ Credits

This project builds upon and integrates work from:

- [PoseAnything](https://github.com/orhir/PoseAnything) by [Or Hirsh](https://github.com/orhir)
- [DINO Tracker](https://github.com/AssafSinger94/dino-tracker) by [Assaf Singer](https://github.com/AssafSinger94)

We thank the authors for making their work open source.

---
